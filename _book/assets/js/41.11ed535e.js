(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{414:function(_,t,v){"use strict";v.r(t);var e=v(7),o=Object(e.a)({},(function(){var _=this,t=_._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("p",[_._v("在smart-socket中将状态机视为一种事件类型。")]),_._v(" "),t("p",[_._v("当事件被触发时会及时回调"),t("code",[_._v("MessageProcessor#stateEvent")]),_._v("方法，所有开发人员可以自由定制自己关心的状态机处理逻辑。比如：新建连接（"),t("code",[_._v("NEW_SESSION")]),_._v("），断开连接("),t("code",[_._v("SESSION_CLOSED")]),_._v(")。")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("状态码")]),_._v(" "),t("th",[_._v("描述")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("NEW_SESSION")]),_._v(" "),t("td",[_._v("连接已建立并实例化Session对象")])]),_._v(" "),t("tr",[t("td",[_._v("REJECT_ACCEPT")]),_._v(" "),t("td",[_._v("拒绝接受连接，仅Server端有效。"),t("RouterLink",{attrs:{to:"/smart-socket/plugin-blacklist.html"}},[_._v("黑名单插件")]),_._v("生效后会触发该状态机。")],1)]),_._v(" "),t("tr",[t("td",[_._v("ACCEPT_EXCEPTION")]),_._v(" "),t("td",[_._v("接受连接异常，仅Server端有效。")])]),_._v(" "),t("tr",[t("td",[_._v("PROCESS_EXCEPTION")]),_._v(" "),t("td",[_._v("业务处理异常。"),t("br"),_._v("执行MessageProcessor.process(AioSession, Object)期间发生未捕获的异常。"),t("strong",[_._v("该状态机仅作为业务逻辑不够健壮的提示，不会影响网络连接。")])])]),_._v(" "),t("tr",[t("td",[_._v("DECODE_EXCEPTION")]),_._v(" "),t("td",[_._v("协议解码异常。"),t("br"),_._v("执行Protocol.decode(ByteBuffer, AioSession)期间发生未捕获的异常。"),t("strong",[_._v("该状态机触发后会自动关闭连接")]),_._v("。")])]),_._v(" "),t("tr",[t("td",[_._v("INPUT_SHUTDOWN")]),_._v(" "),t("td",[_._v("读通道已被关闭，通会话正在关闭中。常由以下几种情况会触发该状态："),t("ol",[t("li",[_._v("对端主动关闭write通道，致使本端满足了EOF条件")]),_._v(" "),t("li",[_._v("当前AioSession处理完读操作后检测到自身正处于SESSION_CLOSING状态")])])])]),_._v(" "),t("tr",[t("td",[_._v("INPUT_EXCEPTION")]),_._v(" "),t("td",[_._v("读操作异常。"),t("br"),_._v("在底层服务执行read操作期间因发生异常情况触发了java.nio.channels.CompletionHandler.failed(Throwable, Object)。")])]),_._v(" "),t("tr",[t("td",[_._v("OUTPUT_EXCEPTION")]),_._v(" "),t("td",[_._v("写操作异常。"),t("br"),_._v("在底层服务执行write操作期间因发生异常情况触发了java.nio.channels.CompletionHandler.failed(Throwable, Object)")])]),_._v(" "),t("tr",[t("td",[_._v("SESSION_CLOSING")]),_._v(" "),t("td",[_._v("会话正在关闭中。"),t("br"),_._v("执行了AioSession.close(false)方法，并且当前还存在待输出的数据。 "),t("strong",[_._v("一般无需关注该状态机。")])])]),_._v(" "),t("tr",[t("td",[_._v("SESSION_CLOSED")]),_._v(" "),t("td",[_._v("会话关闭成功。")])])])]),_._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[_._v("警告")]),_._v(" "),t("p",[_._v("在上述各状态机中，开发人员要重点留意"),t("code",[_._v("PROCESS_EXCEPTION")]),_._v("和"),t("code",[_._v("DECODE_EXCEPTION")]),_._v("，当触发这类状态机，说明你的代码写的不够严谨。")])]),_._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[_._v("注意")]),_._v(" "),t("p",[_._v("遇到"),t("code",[_._v("INPUT_SHUTDOWN")]),_._v("、"),t("code",[_._v("INPUT_EXCEPTION")]),_._v("、"),t("code",[_._v("OUTPUT_EXCEPTION")]),_._v("几种情况不要惊慌，这是网络断开所触发的。\n有可能是你主动调用了close所致，又或者对方断开了连接。如果你确定该现象在业务层面的表现是一种异常，需要排查其中一方是否编解码算法或者业务逻辑有问题。")])])])}),[],!1,null,null,null);t.default=o.exports}}]);